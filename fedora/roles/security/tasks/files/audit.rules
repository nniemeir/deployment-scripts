## Delete existing rules
-D

## Increase buffer size for busy systems
-b 8192

## Failure mode: 1 = printk (log failure), 2 = panic (halt system)
-f 1

# Monitor kernel module operations
-w /sbin/insmod -p x -k modules
-w /sbin/rmmod -p x -k modules
-w /sbin/modprobe -p x -k modules
-a always,exit -F arch=b64 -S init_module,delete_module -k modules

# Monitor account modifications
-w /usr/sbin/useradd -p x -k user_modification
-w /usr/sbin/userdel -p x -k user_modification
-w /usr/sbin/usermod -p x -k user_modification
-w /usr/sbin/groupadd -p x -k group_modification
-w /usr/sbin/groupdel -p x -k group_modification
-w /usr/sbin/groupmod -p x -k group_modification

# Monitor sudo usage
-w /etc/sudoers -p wa -k sudoers
-w /etc/sudoers.d/ -p wa -k sudoers

# Monitor user/group information files
-w /etc/passwd -k ug_info -p wa
-w /etc/group -k ug_info -p rwa
-w /etc/shadow -k ug_info -p rwa
-w /etc/gshadow -k ug_info -p wa
-w /etc/security/opasswd -p wa 

# Monitor service port assignments
-w /etc/services -k serv_ports -p wa

# Monitor use and configuration of at 
-w /var/spool/atspool -k at
-w /etc/at.allow -k at
-w /etc/at.deny -k at

# Monitor changes to cron
-w /etc/cron.allow -k cron -p wa
-w /etc/cron.deny -k cron -p wa
-w /etc/cron.d/ -k cron -p wa
-w /etc/cron.daily/ -k cron -p wa
-w /etc/cron.hourly/ -k cron -p wa
-w /etc/cron.monthly/ -k cron -p wa
-w /etc/cron.weekly/ -k cron -p wa
-w /etc/crontab -k cron -p wa
-w /var/spool/cron/root -k cron -p wa 

# Monitor shadow-utils configs
-w /etc/login.defs -k shadow_configs -p wa

# Monitor changes to which ttys can login as root
-w /etc/securetty -p wa

# Monitor logins
# -w /var/log/lastlog -p wa

# Monitor changes to DNS hosts file
-w /etc/hosts -p wa

# Monitor changes to service scripts dir
-w /usr/lib/systemd/system/

# Monitor changes to dynamic library paths
-w /etc/ld.so.conf -p wa

# Monitor changes to kernel parameters
-w /etc/sysctl.conf -p wa

# Monitor changes to modprobe configs
-w /etc/modprobe.d/
-w /etc/modprobe.conf.local -p wa
-w /etc/modprobe.conf -p wa

# Monitor changes to PAM configs
-w /etc/pam.d/
-w /etc/pam.conf 

# Monitor changes to SSHD config
-w /etc/ssh/sshd_config

# Monitor changes to issue
-w /etc/issue -p wa
-w /etc/issue.net -p wa

# Monitor changes to login banner
-w /etc/motd -p wa

# Monitor changing of default permissions
-a always,exit -F arch=b32 -S umask
-a always,exit -F arch=b64 -S umask

# Monitor audit logs
-w /var/log/audit -k audit_logs -p wa

## Monitor actions that could change system time
-a always,exit -F arch=b32 -S adjtimex,settimeofday,stime -F key=time-change
-a always,exit -F arch=b64 -S adjtimex,settimeofday -F key=time-change
-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -F key=time-change
-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -F key=time-change
-w /etc/localtime -p wa -k time-change

# Monitor actions that could change system locale (Copied from NISPOM rules in documentation)
-w /etc/issue -p wa -k system-locale
-w /etc/issue.net -p wa -k system-locale
-w /etc/hosts -p wa -k system-locale
-w /etc/hostname -p wa -k system-locale
-w /etc/sysconfig/network -p wa -k system-locale
-a always,exit -F dir=/etc/NetworkManager/ -F perm=wa -F key=system-locale

# Monitor privilege elevation (Copied from PCI DSS rules in documentation)
-a always,exit -F arch=b64 -S setuid -F a0=0 -F exe=/usr/bin/su -F key=10.2.5.b-elevated-privs-session
-a always,exit -F arch=b32 -S setuid -F a0=0 -F exe=/usr/bin/su -F key=10.2.5.b-elevated-privs-session
-a always,exit -F arch=b64 -S setresuid -F a0=0 -F exe=/usr/bin/sudo -F key=10.2.5.b-elevated-privs-session
-a always,exit -F arch=b32 -S setresuid -F a0=0 -F exe=/usr/bin/sudo -F key=10.2.5.b-elevated-privs-session
-a always,exit -F arch=b64 -S execve -C uid!=euid -F euid=0 -F key=10.2.5.b-elevated-privs-setuid
-a always,exit -F arch=b32 -S execve -C uid!=euid -F euid=0 -F key=10.2.5.b-elevated-privs-setuid

# Monitor superuser looking in other home directories (Copied from documentation)
-a always,exit -F dir=/home -F uid=0 -F auid>=1000 -F auid!=unset -C auid!=obj_uid -F key=power-abuse

# Lock configuration from being changed
-e 2